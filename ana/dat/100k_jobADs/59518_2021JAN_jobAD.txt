"SQL Server Job details in SQL 2000 , SQL 2005 , SQL 2008 - Algae Education ServicesPagesHomeAboutPrivacy PolicyContact usCategoriesHomeData ScienceDBMSPythonRExcelSparkStatisticsStatistics - BegineerStatistics - IntermediateStatistics - Advance'HR AnalyticsSub Sub-Menu 1Sub Sub-Menu 2Sub Sub-Menu 3Sub Sub-Menu 4DatabasesDBMSMSSQLServerInternalsArchitectureDBA ScriptsErrorBackup RestoreDeadLockConfigurationHadoopNOSQLMONGODBMYSQLPostgresSQLManagementEnterprise Resource Planning (ERP)ERP-SiteMapBusiness Process Re-engineeringBPR-SiteMapContemporary Approaches to Management (CAM)Sub Sub-Menu 1Sub Sub-Menu 2Sub Sub-Menu 3Sub Sub-Menu 4FinanceCertificatesAgileScrum Master QuestionITILITIL V1Sub-Menu 3Sub Sub-Menu 1Sub Sub-Menu 2Sub Sub-Menu 3Sub Sub-Menu 4Install-GuideMongoDB-WindowsSQLServer-UbuntuSQLServer-WindowsAWS- EC2SPARK-WindowsSPARK-AWSMYSQL-WindowsElasticSearch-UbuntuMariaDbCluster-CentOSPython-WindowsRandRstudio-WindowsFollow by EmailLabelsMSSQL DBA Scripts (97)MSSQL (70)MSSQL Error (51)Slides (42)ERP (34)MSSQL Demo (31)Difference between (30)MSSQL Security (30)Analytics (28)MSSQL Architecture (28)MSSQL Backup Restore (26)MSSQL Internals (25)MSSQL Issues (25)MSSQL Replication (22)Installation (19)Windows (19)MSSQL Install (17)Statistics (16)Indexes (15)Interview Questions (15)Management (14)Spark (12)MSSQL Tuning (11)DBMS (10)Python (10)HADOOP (9)MSSQL T-Log (9)Business Process Re-engineering (8)MSSQL Protocols (8)Marketing (8)Ubuntu (8)Automation (7)Business Intelligence (7)Demo (7)MSSQL Maintenance (7)Analytics Lab (6)Big Data (6)Dead Lock (6)MSSQL Cluster (6)MSSQL Configuration (6)MSSQL Stats (6)MongoDB (6)NoSQL (6)PDW (6)SQL (6)Connection (5)EXCEL (5)Error (5)MSSQL Ports (5)Machine learning (5)Marketing Analytics (4)Memory (4)Power Shell (4)R (4)SSRS (4)Tableau (4)pyspark (4)CSM (3)HR Analytics (3)Hcatalog (3)High Availability (3)Hive (3)MSSQL Locks (3)Must Read (3)Performance Issues (3)Pig (3)Azure (2)CentOS (2)Dumps (2)Elastic-search (2)Firewall (2)Hyper-V (2)ITIL (2)Kubernetes (2)MYSQL (2)Robocopy (2)SPN (2)SSAS (2)SSIS (2)Sqoop (2)Storm (2)Online Tutorial (1)Organ donation (1)SQL Server Job details in SQL 2000 , SQL 2005 , SQL 2008HI AllPlease find script to find Job details in SQL 2000 , SQL 2005 , SQL 2008Thanks to Vidhyasagar for sharing lots of scripts which is useful for our our daily work. Just adding one of them in my blog as an document.Output will be:ServerName Job_Name Job_Status Last_Run_Status Last_Run_Date Run_Duration Next_Scheduled_Run_Date DescriptionLink : http://sql-articles.com/blogs/script-to-find-sql-job-activity-details//****************************************************************/USE MSDBGoSET NOCOUNT ON--Checking for SQL Server verionIF CONVERT(tinyint,(SUBSTRING(CONVERT(CHAR(1),SERVERPROPERTY('productversion')),1,1))) <> 8BEGIN---This is for SQL 2k5 and SQL2k8 serversSET NOCOUNT ONSELECT Convert(varchar(20),SERVERPROPERTY('ServerName')) AS ServerName,j.name AS job_name,CASE j.enabled WHEN 1 THEN 'Enabled' Else 'Disabled' END AS job_status,CASE jh.run_status WHEN 0 THEN 'Error Failed'WHEN 1 THEN 'Succeeded'WHEN 2 THEN 'Retry'WHEN 3 THEN 'Cancelled'WHEN 4 THEN 'In Progress' ELSE'Status Unknown' END AS 'last_run_status',ja.run_requested_date as last_run_date,CONVERT(VARCHAR(10),CONVERT(DATETIME,RTRIM(19000101))+(jh.run_duration * 9 + jh.run_duration % 10000 * 6 + jh.run_duration % 100 * 10) / 216e4,108) AS run_duration,ja.next_scheduled_run_date,CONVERT(VARCHAR(500),jh.message) AS step_descriptionFROM(msdb.dbo.sysjobactivity ja LEFT JOIN msdb.dbo.sysjobhistory jh ON ja.job_history_id = jh.instance_id)join msdb.dbo.sysjobs_view j on ja.job_id = j.job_idWHERE ja.session_id=(SELECT MAX(session_id) from msdb.dbo.sysjobactivity) ORDER BY job_name,job_statusENDELSEBEGIN--This is for SQL2k serversSET NOCOUNT ONDECLARE @SQL VARCHAR(5000)--Getting information from sp_help_job to a temp tableSET @SQL='SELECT job_id,name AS job_name,CASE enabled WHEN 1 THEN ''Enabled'' ELSE ''Disabled'' END AS job_status,CASE last_run_outcome WHEN 0 THEN ''Error Failed''WHEN 1 THEN ''Succeeded''WHEN 2 THEN ''Retry''WHEN 3 THEN ''Cancelled''WHEN 4 THEN ''In Progress'' ELSE''Status Unknown'' END AS last_run_status,CASE RTRIM(last_run_date) WHEN 0 THEN 19000101 ELSE last_run_date END last_run_date,CASE RTRIM(last_run_time) WHEN 0 THEN 235959 ELSE last_run_time END last_run_time,CASE RTRIM(next_run_date) WHEN 0 THEN 19000101 ELSE next_run_date END next_run_date,CASE RTRIM(next_run_time) WHEN 0 THEN 235959 ELSE next_run_time END next_run_time,last_run_date AS lrd, last_run_time AS lrtINTO ##jobdetailsFROM OPENROWSET(''sqloledb'', ''server=(local);trusted_connection=yes'', ''set fmtonly off exec msdb.dbo.sp_help_job'')'exec (@SQL)--Merging run date & time format, adding run duration and adding step descriptionselect Convert(varchar(20),SERVERPROPERTY('ServerName')) AS ServerName,jd.job_name,jd.job_status,jd.last_run_status,CONVERT(DATETIME,RTRIM(jd.last_run_date)) +(jd.last_run_time * 9 + jd.last_run_time % 10000 * 6 + jd.last_run_time % 100 * 10) / 216e4 AS last_run_date,CONVERT(VARCHAR(10),CONVERT(DATETIME,RTRIM(19000101))+(jh.run_duration * 9 + jh.run_duration % 10000 * 6 + jh.run_duration % 100 * 10) / 216e4,108) AS run_duration,CONVERT(DATETIME,RTRIM(jd.next_run_date)) +(jd.next_run_time * 9 + jd.next_run_time % 10000 * 6 + jd.next_run_time % 100 * 10) / 216e4 AS next_scheduled_run_date,CONVERT(VARCHAR(500),jh.message) AS step_descriptionfrom (##jobdetails jd LEFT JOIN msdb.dbo.sysjobhistory jhON jd.job_id=jh.job_id AND jd.lrd=jh.run_date AND jd.lrt=jh.run_time) where step_id=0 or step_id is nullorder by jd.job_name,jd.job_status--dropping the temp tabledrop table ###jobdetailsEND/****************************************************************/TweetNextPrev PostPreviousNext PostNo comments:Write commentsPlease do not enter spam linksSubscribe to: Post Comments (Atom)FollowersFollow by EmailAuthorsMohit T Mohammed Adil Neha R A.Yoga Sai Satwik Aliya Khanum Noble John Paul Tarun Yellogi Yogesh Chetan Das Himanshu Tindwani Jayalakshmi V Justin Jacob Likitha Y Meenakshi Aishwarya Monami Ghosh Naveen Shankar Rahul Menon Rashi Nigam Roshna Rahman Royal George S.V.Kiran SHALINI KANCHAN PANDA Samhitha Yadav Samuel A Satish N Taufeeq RawoofTotal PageviewsPopular PostsWhat is the difference between SMP and MPPDifference Between Mutex vs Semaphore | Interview QuestionHow do I see the full SQL / Query text of a spid?Certified Scrum Master Practice Questions - 2Run SQL Server in a Windows Docker container - Step by StepThanks to all those who have given details in bits and pieces via videos, blogs. I want to set up SQL Server on Docker on Windows. B...Certified Scrum Master Practice Questions - 3Moving Database files of Primary AG server to another diskSQL Server Startup OptionsTableau and ChartsModule - 2 Visit Tableau Public Story on ChartsITIL FOUNDATION EXAM - QUESTION DUMPS 2Below are important question for ITIL Foundation Exam certification: 1. Which of the following best describes the goal of Service Level Ma...Follow on FaceBookCategoriesDBMS (10) ERP (34) EXCEL (5) HADOOP (9) NoSQL (6) Python (10) Spark (12) SQL (6) Tableau (4)Text WidgetServicesMore Services<:nav>Â© 2014 Algae Education Services. Designed by Bloggertheme9"
